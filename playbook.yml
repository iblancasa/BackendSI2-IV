---
- hosts: azure
  sudo: yes
  remote_user: backendsi2
  tasks:
    - name: Actualizar lista de paquetes
      apt: update_cache=yes
    - name: Instalar Node JS
      apt: name=nodejs state=present
      apt: name=node state=present
    - name: Instalar NPM
      apt: name=npm state=present
    - name: Instalar Git
      apt: name=git state=present
    - name: Descargar/Actualizar repo.
      git: repo=https://github.com/iblancasa/BackendSI2-IV.git dest=/home/backendsi2/BackendSI2-IV accept_hostkey=yes
    - name: Crear servicio upstart
      template: src=despliegue.conf dest=/etc/init/backendsi2.conf owner=root group=root mode=0644
    - name: Iniciar aplicaci√≥n
      service: name=backendsi2 state=running

